{"version":3,"sources":["../../../../src/scripts/utlis/dbFail/eventsHandler.js"],"names":["eventsHandler","_id","add","inputValue","document","querySelector","value","window","alert","addHandler","list","_removeRandom","newData","dataGenerator","insertBefore","firstChild","resetInput","listItems","childNodes","forEach","item","classList","contains","removeChild","enterAdd","e","keyCode","showAll","_whetherAppear","appendChild","element","whether","style","display","clickLi","targetLi","target","getAttribute","toggle","removeLi","className","_removeLiHandler","_addRandom","id","parentNode","error","console","log","Error","hasChildNodes","_allDisappear","random","Array","prototype","every","call","showInit","init","showDone","_showWhetherDone","showTodo","whetherDone","showClearDone","showClear","clear"],"mappings":"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","file":"eventsHandler.js","sourcesContent":["import Refresh from '../dbFail/refresh';\nimport General from '../dbGeneral/eventsHandlerGeneral';\nimport itemGenerator from '../templete/itemGenerator';\n\nconst eventsHandler = (() => {\n  let _id = 0; // so the first item's id is 1\n\n  function add() {\n    const inputValue = document.querySelector('#input').value;\n\n    if (inputValue === '') {\n      window.alert('please input a real data~');\n    } else {\n      addHandler(inputValue);\n    }\n  }\n\n  function addHandler(inputValue) {\n    const list = document.querySelector('#list');\n\n    _removeRandom(list);\n    _id += 1;\n    const newData = General.dataGenerator(_id, inputValue);\n    list.insertBefore(itemGenerator(newData), list.firstChild); // push newLi to first\n    General.resetInput();\n  }\n\n  function _removeRandom(list) {\n    const listItems = list.childNodes;\n\n    [...listItems].forEach((item) => {\n      if (item.classList.contains('aphorism')) {\n        list.removeChild(item);\n      }\n    });\n  }\n  // or use for...in\n  // for (const index in listItems) {\n  //   if (listItems.hasOwnProperty(index)) {\n  //     if (listItems[index].classList.contains('aphorism')) {\n  //       list.removeChild(listItems[index]);\n  //     }\n  //   }\n  // }\n\n  function enterAdd(e) {\n    if (e.keyCode === 13) {\n      add();\n    }\n  }\n\n  function showAll() {\n    const list = document.querySelector('#list');\n    const listItems = list.childNodes;\n\n    [...listItems].forEach((item) => {\n      _whetherAppear(item, true);\n      if (item.classList.contains('finished')) {\n        list.removeChild(item);\n        list.appendChild(item); // PUNCHLINE: drop done item\n      }\n    });\n  }\n\n  function _whetherAppear(element, whether) {\n    element.style.display = whether ? 'block' : 'none';\n  }\n\n  function clickLi(e) {\n    const targetLi = e.target;\n    // use event delegation\n\n    if (targetLi.getAttribute('data-id')) {\n      targetLi.classList.toggle('finished');\n      showAll();\n    }\n  }\n\n  // li's [x]'s delete\n  function removeLi(e) {\n    if (e.target.className === 'close') { // use event delegation\n      _removeLiHandler(e.target);\n      _addRandom();\n    }\n  }\n\n  function _removeLiHandler(element) {\n    // use previously stored data\n    const list = document.querySelector('#list');\n    const listItems = list.childNodes;\n    const id = element.parentNode.getAttribute('data-id');\n\n    try {\n      [...listItems].forEach((item) => {\n        if (item.getAttribute('data-id') === id) {\n          list.removeChild(item);\n        }\n      });\n    } catch (error) {\n      console.log('Wrong id, not found in DOM tree');\n      throw new Error(error);\n    }\n  }\n\n  function _addRandom() {\n    const list = document.querySelector('#list');\n\n    if (!list.hasChildNodes() || _allDisappear(list)) {\n      Refresh.random();\n    }\n  }\n\n  function _allDisappear(list) {\n    const listItems = list.childNodes;\n\n    return Array.prototype.every.call(listItems, item => item.style.display === 'none');\n  }\n\n  function showInit() {\n    Refresh.init();\n  }\n\n  function showDone() {\n    _showWhetherDone(true);\n  }\n\n  function showTodo() {\n    _showWhetherDone(false);\n  }\n\n  function _showWhetherDone(whetherDone) {\n    const list = document.querySelector('#list');\n    const listItems = list.childNodes;\n\n    _removeRandom(list);\n    [...listItems].forEach((item) => {\n      item.classList.contains('finished') ? _whetherAppear(item, whetherDone) : _whetherAppear(item, !whetherDone);\n    });\n    _addRandom();\n  }\n\n  function showClearDone() {\n    const list = document.querySelector('#list');\n    const listItems = list.childNodes;\n\n    _removeRandom(list);\n    [...listItems].forEach((item) => {\n      if (item.classList.contains('finished')) {\n        list.removeChild(item);\n      }\n    });\n    _addRandom();\n  }\n\n  function showClear() {\n    Refresh.clear(); // clear nodes visually\n    Refresh.random();\n  }\n\n  return {\n    add,\n    enterAdd,\n    clickLi,\n    removeLi,\n    showInit,\n    showAll,\n    showDone,\n    showTodo,\n    showClearDone,\n    showClear,\n  };\n})();\n\nexport default eventsHandler;\n"]}