!function e(t,n,o){function r(u,a){if(!n[u]){if(!t[u]){var i="function"==typeof require&&require;if(!a&&i)return i(u,!0);if(c)return c(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var s=n[u]={exports:{}};t[u][0].call(s.exports,function(e){var n=t[u][1][e];return r(n||e)},s,s.exports,e,t,n,o)}return n[u].exports}for(var c="function"==typeof require&&require,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(e,t,n){"use strict";var o=function(){function e(e,t){var n=indexedDB.open(e.name,e.version);u=e.storeName,n.onerror=function(){console.log("Pity, fail to load indexedDB")},n.onsuccess=function(e){r=e.target.result,o(t)},n.onupgradeneeded=function(t){if(!(r=t.target.result).objectStoreNames.contains(u))var n=r.createObjectStore(u,{keyPath:e.key,autoIncrement:!0});n.add(e.dataDemo)}}function t(e){return(e?r.transaction([u],"readwrite"):r.transaction([u])).objectStore(u)}function n(){return IDBKeyRange.lowerBound(0,!0)}function o(e){var n=t(!0),o=IDBKeyRange.lowerBound(0);n.openCursor(o,"next").onsuccess=function(t){var n=t.target.result;n?(n.continue(),c=n.value.id):(console.log("now key is:"+c),e())}}var r,c,u;return{init:function(t,n){return window.indexedDB?(n&&e(t,n),0):(window.alert("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available."),0)},getKey:function(){return c+=1},add:function(e,n,o){var r=t(!0).add(e);r.onerror=function(){console.log("Pity, failed to add one data to indexedDB")},r.onsuccess=function(){console.log("Bravo, success to add one data to indexedDB"),n&&(o?n.apply(null,o):n())}},get:function(e,n,o){var r=t(!1).get(e);r.onerror=function(){console.log("Pity, get (key:"+e+"')s data faild")},r.onsuccess=function(){console.log("Great, get (key:"+e+"')s data succeed"),o?(o.unshift(r.result),n.apply(null,o)):n(r.result)}},getWhether:function(e,o,r,c){var u=[],a=t(!0),i=n();a.openCursor(i,"next").onsuccess=function(t){var n=t.target.result;n?(e?n.value[o]&&u.push(n.value):e||n.value[o]||u.push(n.value),n.continue()):c?(c.unshift(u),r.apply(null,c)):r(u)}},getAll:function(e,o){var r=t(!0),c=n(),u=[];r.openCursor(c,"next").onsuccess=function(t){var n=t.target.result;n?(u.push(n.value),n.continue()):o?(o.unshift(u),e.apply(null,o)):e(u)}},update:function(e,n,o){var r=t(!0).put(e);r.onerror=function(){console.log("Pity, modify failed")},r.onsuccess=function(){console.log("Aha, modify succeed"),n&&(o?n.apply(null,o):n())}},delete:function(e,n,o){var r=t(!0).delete(e);r.onerror=function(){console.log("delete (key:"+e+"')s value faild")},r.onsuccess=function(){console.log("delete (key: "+e+"')s value succeed"),n&&(o?n.apply(o):n())}},clear:function(e,o){var r=t(!0),c=n();r.openCursor(c,"next").onsuccess=function(t){var n,r=t.target.result;r?((n=r.delete()).onsuccess=function(){},n.onerror=function(){console.log("Pity, delete all data faild")},r.continue()):e&&(console.log("Great, clear succeed"),o?e.apply(null,this):e())}}}}();t.exports=o},{}],2:[function(e,t,n){"use strict";!function(){function t(){n(),k.getAll(o)}function n(){for(var e=document.querySelector("#myUl");e.hasChildNodes();)e.removeChild(e.firstChild)}function o(e){var t=document.createDocumentFragment(),n=document.createDocumentFragment(),o=document.createDocumentFragment();e.map(function(e){e.finished?n.insertBefore(r(e),n.firstChild):t.insertBefore(r(e),t.firstChild)}),o.appendChild(t),o.appendChild(n),document.querySelector("#myUl").appendChild(o),console.log("Refresh list, and show succeed")}function r(e){var t=document.createElement("li");return u(t,e),t}function c(e,t){var n=document.createElement("span"),o=document.createTextNode("×");n.appendChild(o),n.className="close",a(n,"data-x",t),e.appendChild(n)}function u(e,t){var n=document.createTextNode(t.userDate+": "),o=document.createElement("span"),r=document.createTextNode(" "+t.event);o.appendChild(r),e.appendChild(n),e.appendChild(o),t.finished&&e.classList.add("checked"),a(e,"data-id",t.id),c(e,t.id)}function a(e,t,n){e.setAttribute(t,n)}function i(){var e,t,n=document.querySelector("#myInput").value,o=document.querySelector("#myUl");return""===n?(alert("please input a real data~"),!1):(e=d(n),t=r(e),o.insertBefore(t,o.firstChild),n="",k.add(e),0)}function d(e){return{id:k.getKey(),event:e,finished:!1,userDate:x("yyyy年MM月dd日 hh:mm")}}function s(e){13===e.keyCode&&i()}function l(e){var t,n=e.target;n.getAttribute("data-id")&&(t=parseInt(n.getAttribute("data-id"),10),k.get(t,f,[n]))}function f(e,n){n.finished=!e.finished,n.finished?n.classList.add("checked"):n.classList.remove("checked"),e.finished=n.finished,k.update(e,t)}function p(e){"close"===e.target.className&&g(parseInt(e.target.getAttribute("data-x"),10))}function g(e){k.delete(e,t)}function v(e){n(),k.getWhether(e,"finished",o),console.log("Aha, show data succeed")}function h(){v(!0)}function m(){v(!1)}function y(){n(),k.clear()}function x(e){var t,n=new Date,o=e,r={"y+":n.getFullYear(),"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes()};for(var c in r)new RegExp("("+c+")").test(o)&&("y+"===c?o=o.replace(RegExp.$1,(""+r[c]).substr(4-RegExp.$1.length)):"S+"===c?(t=1===(t=RegExp.$1.length)?3:t,o=o.replace(RegExp.$1,("00"+r[c]).substr((""+r[c]).length-1,t))):o=o.replace(RegExp.$1,1===RegExp.$1.length?r[c]:("00"+r[c]).substr((""+r[c]).length)));return o}var k=e("indexeddb-crud"),C={name:"justToDo",version:"6",key:"id",storeName:"user"};C.dataDemo={id:0,event:0,finished:!0,date:0},k.init(C,function(){var e=document.querySelector("#myUl");t(),e.addEventListener("click",l,!1),e.addEventListener("click",p,!1),document.querySelector("#add").addEventListener("click",i,!1),document.addEventListener("keydown",s,!0),document.querySelector("#done").addEventListener("click",h,!1),document.querySelector("#todo").addEventListener("click",m,!1),document.querySelector("#all").addEventListener("click",t,!1),document.querySelector("#clear").addEventListener("click",y,!1)})}()},{"indexeddb-crud":1}]},{},[2]);