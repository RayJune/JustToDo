!function e(t,n,o){function r(c,a){if(!n[c]){if(!t[c]){var u="function"==typeof require&&require;if(!a&&u)return u(c,!0);if(i)return i(c,!0);var d=new Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d}var s=n[c]={exports:{}};t[c][0].call(s.exports,function(e){var n=t[c][1][e];return r(n||e)},s,s.exports,e,t,n,o)}return n[c].exports}for(var i="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,t,n){"use strict";var o=function(){function e(e,n){var o=indexedDB.open(e.name,e.version);a=e.storeName,o.onerror=function(){console.log("Pity, fail to load indexedDB")},o.onsuccess=function(e){i=e.target.result,t(n)},o.onupgradeneeded=function(t){var n;(i=t.target.result).objectStoreNames.contains(a)||(n=i.createObjectStore(a,{keyPath:e.key,autoIncrement:!0})),n.add(e.dataDemo)}}function t(e){var t=n(!0),o=IDBKeyRange.lowerBound(0);t.openCursor(o,"next").onsuccess=function(t){var n=t.target.result;n?(n.continue(),c=n.value.id):(console.log("now key is:"+c),e())}}function n(e){return(e?i.transaction([a],"readwrite"):i.transaction([a])).objectStore(a)}function o(){return IDBKeyRange.lowerBound(0,!0)}function r(e,t,n){n?(n.unshift(t),e.apply(null,n)):e(t)}var i,c,a;return{init:function(t,n){return window.indexedDB?(n&&e(t,n),0):(window.alert("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available."),0)},getNewDataKey:function(){return c+=1},add:function(e,t,o){var i=n(!0).add(e);i.onerror=function(){console.log("Pity, failed to add one data to indexedDB")},i.onsuccess=function(){console.log("Bravo, success to add one data to indexedDB"),t&&r(t,e,o)}},get:function(e,t,o){var i=n(!1).get(e);i.onerror=function(){console.log("Pity, get (key:"+e+"')s data faild")},i.onsuccess=function(){console.log("Great, get (key:"+e+"')s data succeed"),r(t,i.result,o)}},getWhether:function(e,t,i,c){var a=n(!0),u=o(),d=[];a.openCursor(u,"next").onsuccess=function(n){var o=n.target.result;o?(e?o.value[t]&&d.push(o.value):e||o.value[t]||d.push(o.value),o.continue()):r(i,d,c)}},getAll:function(e,t){var i=n(!0),c=o(),a=[];i.openCursor(c,"next").onsuccess=function(n){var o=n.target.result;o?(a.push(o.value),o.continue()):r(e,a,t)}},update:function(e,t,o){var i=n(!0).put(e);i.onerror=function(){console.log("Pity, modify failed")},i.onsuccess=function(){console.log("Aha, modify succeed"),t&&r(t,e,o)}},delete:function(e,t,o){var i=n(!0).delete(e);i.onerror=function(){console.log("delete (key:"+e+"')s value faild")},i.onsuccess=function(){console.log("delete (key: "+e+"')s value succeed"),t&&r(t,e,o)}},clear:function(e,t){var i=n(!0),c=o();i.openCursor(c,"next").onsuccess=function(n){var o,i=n.target.result;i?((o=i.delete()).onsuccess=function(){},o.onerror=function(){console.log("Pity, delete all data faild")},i.continue()):e&&r(e,"all data",t)}}}}();t.exports=o},{}],2:[function(e,t,n){"use strict";!function(){function t(){n(),k.getAll(o)}function n(){for(var e=document.querySelector("#list");e.hasChildNodes();)e.removeChild(e.firstChild)}function o(e){0===e.length?r():i(e)}function r(){var e=document.createElement("li"),t=document.createTextNode("Welcome~, try to add your first to-do list : )");d(e,"data-id","init"),e.appendChild(t),document.querySelector("#list").appendChild(e),console.log("init list")}function i(e){var t=document.createDocumentFragment(),n=document.createDocumentFragment(),o=document.createDocumentFragment();e.forEach(function(e){e.finished?n.insertBefore(c(e),n.firstChild):t.insertBefore(c(e),t.firstChild)}),o.appendChild(t),o.appendChild(n),document.querySelector("#list").appendChild(o),console.log("Refresh list, and show succeed")}function c(e){var t=document.createElement("li");return a(t,e),t}function a(e,t){var n=document.createTextNode(t.userDate+": "),o=document.createElement("span"),r=document.createTextNode(" "+t.event);o.appendChild(r),e.appendChild(n),e.appendChild(o),t.finished&&e.classList.add("checked"),u(e,t.id),d(e,"data-id",t.id)}function u(e,t){var n=document.createElement("span"),o=document.createTextNode("×");n.appendChild(o),n.className="close",d(n,"data-x",t),e.appendChild(n)}function d(e,t,n){e.setAttribute(t,n)}function s(e){13===e.keyCode&&l()}function l(){var e,t,n,o=document.querySelector("#input").value;return""===o?(alert("please input a real data~"),!1):(f(),t=g(o),n=c(t),(e=document.querySelector("#list")).insertBefore(n,e.firstChild),document.querySelector("#input").value="",k.add(t),0)}function f(){"init"===document.querySelector("#list").firstChild.getAttribute("data-id")&&n()}function g(e){return{id:k.getNewDataKey(),event:e,finished:!1,userDate:E("yyyy年MM月dd日 hh:mm")}}function h(e){var t,n=e.target;n.getAttribute("data-id")&&(t=parseInt(n.getAttribute("data-id"),10),k.get(t,p,[n]))}function p(e,n){n.finished=!e.finished,n.finished?n.classList.add("checked"):n.classList.remove("checked"),e.finished=n.finished,k.update(e,t)}function v(e){"close"===e.target.className&&m(parseInt(e.target.getAttribute("data-x"),10))}function m(e){k.delete(e,t)}function y(e){n(),k.getWhether(e,"finished",i),console.log("Aha, show data succeed")}function x(){y(!0)}function C(){y(!1)}function D(){n(),k.clear()}function E(e){var t,n=new Date,o=e,r={"y+":n.getFullYear(),"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes()};for(var i in r)new RegExp("("+i+")").test(o)&&("y+"===i?o=o.replace(RegExp.$1,(""+r[i]).substr(4-RegExp.$1.length)):"S+"===i?(t=1===(t=RegExp.$1.length)?3:t,o=o.replace(RegExp.$1,("00"+r[i]).substr((""+r[i]).length-1,t))):o=o.replace(RegExp.$1,1===RegExp.$1.length?r[i]:("00"+r[i]).substr((""+r[i]).length)));return o}var k=e("indexeddb-crud"),w={name:"justToDo",version:"6",key:"id",storeName:"user"};w.dataDemo={id:0,event:0,finished:!0,date:0},k.init(w,function(){var e=document.querySelector("#list");t(),e.addEventListener("click",h,!1),e.addEventListener("click",v,!1),document.querySelector("#add").addEventListener("click",l,!1),document.addEventListener("keydown",s,!1),document.querySelector("#done").addEventListener("click",x,!1),document.querySelector("#todo").addEventListener("click",C,!1),document.querySelector("#show").addEventListener("click",t,!1),document.querySelector("#clear").addEventListener("click",D,!1)})}()},{"indexeddb-crud":1}]},{},[2]);